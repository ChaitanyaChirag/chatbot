(this.webpackJsonpchatbot=this.webpackJsonpchatbot||[]).push([[2],{1:function(e,t,a){"use strict";a.d(t,"t",(function(){return c})),a.d(t,"q",(function(){return l})),a.d(t,"d",(function(){return d})),a.d(t,"g",(function(){return u})),a.d(t,"b",(function(){return _})),a.d(t,"n",(function(){return p})),a.d(t,"p",(function(){return E})),a.d(t,"o",(function(){return S})),a.d(t,"a",(function(){return g})),a.d(t,"h",(function(){return f})),a.d(t,"s",(function(){return h})),a.d(t,"i",(function(){return T})),a.d(t,"k",(function(){return b})),a.d(t,"m",(function(){return O})),a.d(t,"l",(function(){return m})),a.d(t,"j",(function(){return y})),a.d(t,"e",(function(){return A})),a.d(t,"f",(function(){return v})),a.d(t,"r",(function(){return N})),a.d(t,"c",(function(){return D}));var n=a(6),o=a(2);function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var r=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)},s=!0,c=function(){var e=(new Date).getTime();return"".concat(e,"_").concat(r()+r()+r()+r())},l=function(e,t){s&&(t?console.log(e,t):console.log(e))},d=function(e){return new Promise((function(t){var a=new FileReader;a.onload=function(e){t(e.target.result)},a.readAsDataURL(e)}))},u=function(e){var t=document.cookie.match("(^|;) ?"+e+"=([^;]*)(;|$)");return t?t[2]:null},_={ANDROID:"android",WEBSITE:"website"},p=function(){return window.ori_platform&&void 0!==window.ori_platform&&window.ori_platform.toLowerCase()===_.ANDROID?_.ANDROID:_.WEBSITE},E=function(){var e=p();return e&&e.toLowerCase()===_.ANDROID},S=function(){var e=null;return localStorage.getItem("psid")?e=localStorage.getItem("psid"):(e=c(),localStorage.setItem("psid",e)),e},g={MESSAGES:S,UNSEEN_MESSAGES:"unseen_messages",NOTIFICATION_COUNT:"notification_count",LAST_EMIT:"last_emit",PSID:"psid",IS_CHAT_OPEN:"is_chat_open",ANDROID:"android",APP_PARAMS:"app_params",END_CHAT:"end_chat"},f=function(e,t){var a=localStorage.getItem(e);return a&&void 0!==a?JSON.parse(a):t},h=function(e,t){var a=JSON.stringify(t);localStorage.setItem(e,a)},T=function(){return E()?o.i:o.j},b=function(){return localStorage.getItem(g.MESSAGES())?JSON.parse(localStorage.getItem(g.MESSAGES())):T()},O=function(){return localStorage.getItem(g.UNSEEN_MESSAGES)?JSON.parse(localStorage.getItem(g.UNSEEN_MESSAGES)):[]},m=function(){return localStorage.getItem(g.NOTIFICATION_COUNT)?JSON.parse(localStorage.getItem(g.NOTIFICATION_COUNT)):0},y=function(){return!!localStorage.getItem(g.IS_CHAT_OPEN)&&JSON.parse(localStorage.getItem(g.IS_CHAT_OPEN))},A=function(e,t){return new Date(e).toLocaleDateString("en-In",t)},v=function(e,t){return new Date(e).toLocaleTimeString("en-In",t)},N=function(e){e&&(e.scrollTop=e.scrollHeight)},D={screen_data:function(){return{screen_width:window.innerWidth,screen_height:window.innerHeight,screen_orientation:this.screen_orientation(),screen_type:this.screen_type()}},screen_orientation:function(){return window.matchMedia("(orientation:landscape)").matches?"landscape":"portrait"},screen_type:function(){return window.innerWidth<=480?"xs":window.innerWidth<=768?"sm":window.innerWidth<=992?"md":window.innerWidth<=1200?"lg":window.innerWidth<=1600?"hd":window.innerWidth<=2560?"fhd":"uhd"},deviceStatus:function(){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(a,!0).forEach((function(t){Object(n.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},this.screen_data())}}},167:function(e,t,a){e.exports=a(347)},2:function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"d",(function(){return o})),a.d(t,"h",(function(){return i})),a.d(t,"g",(function(){return r})),a.d(t,"e",(function(){return s})),a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return l})),a.d(t,"f",(function(){return d})),a.d(t,"j",(function(){return u})),a.d(t,"i",(function(){return _}));var n={ERROR:"error"},o={CONNECT:"connect",DISCONNECT:"disconnect",CONNECT_ERROR:"connect_error",ERROR:"error",RESPONSE:"response",NEW_MESSAGE:"new_message",RESET_CHAT:"reset_chat",SHOW_TYPING:"show_typing",BOT_AUTO_POPUP_REQUEST:"botAutoPopupRequest",RECORD_FEEDBACK:"recordFeedback",GET_WEBSITE_DATA:"getWebsiteData",WEBSITE_DATA:"websiteData",CHATLOG_FEEDBACK:"chatlogFeedback",TYPING_STATUS:"typingStatus",UPDATE_MESSAGE:"updateMessage",UPDATE_ADMIN_MESSAGE:"updateAdminMessage",MESSAGE_SEEN:"messageSeen",END_CONVERSATION:"end_conversation",END_CONVERSATION_FORM_SUBMIT:"end_conversation_form_submit"},i={TEXT:"text",LIST:"list",TEXT_WITH_BUTTONS:"text_with_buttons",IMAGE_WITH_BUTTONS:"image_with_buttons",CHECKBOX_WITH_MEDIA:"checkbox_with_media",VIDEO:"video",TIMER:"timer",CAROUSEL:"carousel",CUSTOM_MSG:"customMsg",NOTIFICATION:"notification",UPLOAD_FILE:"uploadFile",FILE:"file",SYSTEM_TEXT:"systemText"},r={DISH_RECHARGE:"dishRecharge",DISH_RECHARGE_DETAILS:"dishRechargeDetails",DISH_OFFERS:"dishOffers",DISH_RECHARGE_HISTORY:"dishRechargeHistory"},s={SENDING:"sending",SENT:"sent",DELIVERED:"delivered",SEEN:"seen",FAILED:"failed"},c={LINK:"link",DEFAULT:"default",CUSTOM:"custom",CUSTOM_SOCKET_EVENT:"customSocketEvent",POST_BACK_RESPONSE:"postbackRes"},l={DISH_OFFERS:"dishOffers",CHECKBOX_SUBMIT:"checkboxSubmit"},d={SYSTEM:"system",CUSTOMER:"customer",ADMIN:"admin",CHATBOT:"chatbot"},u=[{sender:d.CHATBOT,type:i.TEXT,inputLock:!1,quickReply:[],skipLS:!1,send_variable_to_apiai:!1,sendVariableToLS:!1,variable_name:"",delay:0,payload:{text:"Hi, I'm ADI, Your Personal DishTV Assistant."},timestamp:new Date},{sender:d.CHATBOT,inputLock:!1,skipLS:!1,send_variable_to_apiai:!1,sendVariableToLS:!1,variable_name:"",quickReplies:[],type:i.TEXT_WITH_BUTTONS,delay:0,payload:{title:"",subtitle:"What can I help you with today?",buttons:[{type:c.DEFAULT,text:"Recharge My Dish TV",url:""},{type:c.DEFAULT,text:"Recharge Offers",url:""},{type:c.DEFAULT,text:"Current Balance",url:""},{type:c.DEFAULT,text:"Other Queries",url:""}]},timestamp:new Date}],_=[{sender:d.CHATBOT,type:i.TEXT,inputLock:!1,quickReply:[],skipLS:!1,send_variable_to_apiai:!1,sendVariableToLS:!1,variable_name:"",delay:0,payload:{text:"Hi, I'm ADI, Your Personal DishTV Assistant."},timestamp:new Date},{sender:d.CHATBOT,inputLock:!1,skipLS:!1,send_variable_to_apiai:!1,sendVariableToLS:!1,variable_name:"",quickReplies:[],type:i.TEXT_WITH_BUTTONS,delay:0,payload:{title:"",subtitle:"What can I help you with today?",buttons:[{type:c.DEFAULT,text:"My DishTV is not working",url:""},{type:c.DEFAULT,text:"Recharge Offers",url:""},{type:c.DEFAULT,text:"Current Balance",url:""},{type:c.DEFAULT,text:"Package details",url:""},{type:c.DEFAULT,text:"Other Queries",url:""}]},timestamp:new Date}]},203:function(e,t){},277:function(e,t,a){},340:function(e,t,a){},346:function(e,t,a){},347:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"updateState",(function(){return h})),a.d(n,"updateEndChat",(function(){return T})),a.d(n,"makeSocketConnection",(function(){return b})),a.d(n,"socketDisconnect",(function(){return O})),a.d(n,"handleBotPopupRequest",(function(){return m})),a.d(n,"emitCustomEvent",(function(){return y})),a.d(n,"emitNewMessageToServer",(function(){return A})),a.d(n,"pushSenderMessage",(function(){return v})),a.d(n,"onMessageVoting",(function(){return N})),a.d(n,"resetChat",(function(){return D})),a.d(n,"sendFeedback",(function(){return C})),a.d(n,"handleChatbotInterface",(function(){return I})),a.d(n,"setDefaultState",(function(){return k})),a.d(n,"updateFileUploadMessage",(function(){return P}));var o={};a.r(o),a.d(o,"setDeviceData",(function(){return ce})),a.d(o,"enableAdsterBot",(function(){return le}));var i=a(0),r=a.n(i),s=a(26),c=a.n(s),l=a(59),d=a(9),u=a(6),_=a(148),p=a.n(_),E=a(2),S=a(4),g=a(1),f={DEVICE_DATA_LOADED:"DEVICE_DATA_LOADED",ENABLE_ADSTER_BOT:"ENABLE_ADSTER_BOT",UPDATE_STATE:"UPDATE_STATE",UPDATE_END_CHAT:"UPDATE_END_CHAT",MAKE_SOCKET_CONNECTION:"MAKE_SOCKET_CONNECTION",SOCKET_DISCONNECT:"SOCKET_DISCONNECT",BOT_POPUP_REQUEST:"BOT_POPUP_REQUEST",EMIT_NEW_MESSAGE:"EMIT_NEW_MESSAGE",EMIT_CUSTOM_EVENT:"EMIT_CUSTOM_EVENT",MESSAGE_VOTING:"MESSAGE_VOTING",RESET_CHAT:"RESET_CHAT",SEND_FEEDBACK:"SEND_FEEDBACK",UPDATE_TYPING_INFO:"UPDATE_TYPING_INFO",UPDATE_MESSAGE:"UPDATE_MESSAGE",MESSAGE_SEEN:"MESSAGE_SEEN",UPDATE_PSID:"UPDATE_PSID",HANDLE_CHATBOT_INTERFACE:"HANDLE_CHATBOT_INTERFACE",SOCKET_CONNECTED:"SOCKET_CONNECTED",SOCKET_CONNECT_ERROR:"SOCKET_CONNECT_ERROR",SOCKET_ERROR:"SOCKET_ERROR",PUSH_RESPONSE_MESSAGE:"PUSH_RESPONSE_MESSAGE",PUSH_SENDER_MESSAGE:"PUSH_SENDER_MESSAGE",SET_DEFAULT_STATE:"SET_DEFAULT_STATE",SHOW_TYPING:"SHOW_TYPING",CLEAR_UNSEEN_MESSAGES:"CLEAR_UNSEEN_MESSAGES",GET_WEBSITE_DATA:"GET_WEBSITE_DATA",UPDATE_FILE_UPLOAD_MESSAGE:"UPDATE_FILE_UPLOAD_MESSAGE"},h=function(e,t){return{type:f.UPDATE_STATE,payload:t,key:e}},T=function(e){return{type:f.UPDATE_END_CHAT,payload:e}},b=function(){return{type:f.MAKE_SOCKET_CONNECTION}},O=function(){return{type:f.SOCKET_DISCONNECT}},m=function(e){return{type:f.BOT_POPUP_REQUEST,payload:e}},y=function(e,t,a){return{type:f.EMIT_CUSTOM_EVENT,payload:t,event:e,callback:a}},A=function(e){return{type:f.EMIT_NEW_MESSAGE,payload:e}},v=function(e){return{type:f.PUSH_SENDER_MESSAGE,payload:{message:e}}},N=function(e){return{type:f.MESSAGE_VOTING,payload:e}},D=function(e,t){return{type:f.RESET_CHAT,payload:e,callback:t}},C=function(e,t){return{type:f.SEND_FEEDBACK,payload:e,callback:t}},I=function(e){return{type:f.HANDLE_CHATBOT_INTERFACE,payload:e}},k=function(){var e={messages:Object(g.k)()};return{type:f.SET_DEFAULT_STATE,payload:e}},P=function(e){return{type:f.UPDATE_FILE_UPLOAD_MESSAGE,payload:e}};function w(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var M=function(e,t){t.on(E.d.CONNECT,(function(){Object(g.q)("socket connected",t);var a=e.getState().chat_details;e.dispatch(h("is_socket_connected",t.connected));var n=Object(g.i)();if(S.b.auto_emit_response.enable&&a.messages.length===n.length){var o=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?w(a,!0).forEach((function(t){Object(u.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):w(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},S.b.auto_emit_response.payload,{session_id:t.io.engine.id,current_session_id:t.io.engine.id,sender_id:S.a.sender_id,navigator_userAgent:navigator.userAgent,navigator_platform:navigator.platform,variable_name:a.variable_name,send_variable_to_apiai:a.send_variable_to_apiai,sendVariableToLS:a.sendVariableToLS,skipLS:a.skipLS});console.log("first emit data",o),t.emit(E.d.NEW_MESSAGE,o)}if(a.psid){var i={clientPsid:a.psid,senderPsid:a.psid};e.dispatch(y(E.d.MESSAGE_SEEN,i))}})),t.on(E.d.CONNECT_ERROR,(function(a){Object(g.q)("socket connect error",a),e.dispatch(h("is_socket_connected",t.connected))})),t.on(E.d.ERROR,(function(a){Object(g.q)(" socket error",a),e.dispatch(h("is_socket_connected",t.connected))})),t.on(E.d.DISCONNECT,(function(a){"io server disconnect"===a&&t.connect(),e.dispatch(h("is_socket_connected",t.connected))})),t.on(E.d.RESPONSE,(function(a){Object(g.q)("response",a);var n=e.getState().chat_details;if(a&&a.psid&&a.psid===n.psid){var o={message:a.result&&a.result.bot_messages&&a.result.bot_messages.length>0?a.result.bot_messages[0]:null};if(o.message){if(o.message.cmid=Object(g.t)(),a.chatlogId){var i={readStatus:E.e.DELIVERED,clientPsid:n.psid,senderPsid:n.psid,chatlogId:a.chatlogId};t.emit(E.d.UPDATE_ADMIN_MESSAGE,i,(function(e){if(!e&&"visible"===document.visibilityState&&n.is_chat_open){var a={clientPsid:n.psid,senderPsid:n.psid};t.emit(E.d.MESSAGE_SEEN,a)}}))}e.dispatch({type:f.PUSH_RESPONSE_MESSAGE,payload:o})}else Object(g.q)("response data format is not correct",a)}})),t.on(E.d.GET_WEBSITE_DATA,(function(a){var n=e.getState().chat_details;if(a&&a.length>0){var o={};a.forEach((function(e){"cookie"===e.source?o[e.newKey]=Object(g.g)(e.key):"localstorage"===e.source&&(o[e.newKey]=localStorage.getItem(e.key))})),t.emit(E.d.WEBSITE_DATA,{websiteData:o,psid:n.psid})}})),t.on(E.d.TYPING_STATUS,(function(t){var a=e.getState().chat_details;t&&t.typingInfo&&t.typingInfo.senderPsid!==a.psid&&e.dispatch({type:f.UPDATE_TYPING_INFO,payload:t.typingInfo})})),t.on(E.d.UPDATE_MESSAGE,(function(t){var a=e.getState().chat_details;t&&t.updateChatlogId&&t.updateChatlogId.changedValue&&t.updateChatlogId.psid&&t.updateChatlogId.psid===a.psid?e.dispatch({type:f.UPDATE_MESSAGE,payload:t.updateChatlogId,key:"cmid"}):t&&t.updatedCustomerMessage&&t.updatedCustomerMessage.changedValue&&t.updatedCustomerMessage.clientPsid===a.psid?e.dispatch({type:f.UPDATE_MESSAGE,payload:t.updatedCustomerMessage,key:"chatlogId"}):t&&t.messageSeen&&t.messageSeen.clientPsid===a.psid&&t.messageSeen.senderPsid!==a.psid&&e.dispatch({type:f.MESSAGE_SEEN})})),t.on(E.d.END_CONVERSATION,(function(t){Object(g.q)("end conversation listener",t);var a=e.getState().chat_details;t.psid===a.psid&&e.dispatch({type:f.UPDATE_END_CHAT,payload:{visible:!0,show_resolved_card:!0}})}))},R=function(){var e=null;return function(t){return function(a){return function(n){switch(n.type){case f.MAKE_SOCKET_CONNECTION:null!==e&&e.close();var o=Object(S.d)();e=p()(o),M(t,e);break;case f.EMIT_CUSTOM_EVENT:e&&n.event&&(Object(g.q)("emit custom event",n.payload),n.callback?e.emit(n.event,n.payload,n.callback):e.emit(n.event,n.payload));break;case f.EMIT_NEW_MESSAGE:e&&(n.payload.session_id=e.io.engine.id,n.payload.current_session_id=e.io.engine.id,e.emit(E.d.NEW_MESSAGE,n.payload,(function(e,a){if(e){Object(g.q)("emit new message event error",e);var o={cmid:n.payload.cmid,changedValue:{readStatus:E.e.FAILED}};t.dispatch({type:f.UPDATE_MESSAGE,payload:o,key:"cmid"})}else!e&&a&&a.data&&a.data.cmid&&a.data.changedValue&&t.dispatch({type:f.UPDATE_MESSAGE,payload:a.data,key:"cmid"})})));break;case f.BOT_POPUP_REQUEST:e&&e.emit(E.d.BOT_AUTO_POPUP_REQUEST,n.payload,(function(e,a){if(!e&&a&&a.data&&a.data.displayMessage){Object(g.q)("bot auto popup request response",a);var n=a.data.displayMessage;t.dispatch({type:f.PUSH_SENDER_MESSAGE,payload:{message:n}})}else Object(g.q)("bot auto popup request error",e)}));break;case f.MESSAGE_VOTING:e&&e.emit(E.d.CHATLOG_FEEDBACK,n.payload,(function(e){if(Object(g.q)("chatlog feedback res",e),!e.error&&e.data&&e.data.chatlogId&&e.data.voteType){var a={chatlogId:e.data.chatlogId,changedValue:{voteType:e.data.voteType}};t.dispatch({type:f.UPDATE_MESSAGE,key:"chatlogId",payload:a})}else Object(g.q)("chatlog feedback event request error")}));break;case f.RESET_CHAT:e&&e.emit(E.d.RESET_CHAT,n.payload,(function(e){Object(g.q)("chatlog feedback res",e),e.ok?n.callback():e.error&&Object(g.q)("reset chat event error")}));break;case f.SEND_FEEDBACK:e&&e.emit(E.d.RECORD_FEEDBACK,n.payload,(function(e,t){n.callback&&n.callback(e)}));break;case f.SOCKET_DISCONNECT:null!==e&&(Object(g.q)("socket disconnected",e),e.close()),e=null;break;default:return a(n)}}}}}(),j=a(5),U=a(96),L=a.n(U),G=Object(g.o)(),B=Object(g.k)(),H=Object(g.m)(),x=Object(g.j)(),F=Object(g.l)(),V={chat_details:{is_socket_connected:!1,is_internet_connected:!1,psid:G,messages:Object(g.p)()?Object(g.i)():B,unseen_messages:H,notification_count:F,is_chat_open:x,is_typing:!1,typing_text:"",quick_replies:B&&B.length>0&&B[B.length-1].sender===E.f.SERVER&&B[B.length-1].quickReplies?B[B.length-1].quickReplies:[],is_input_lock:!!(B&&B.length>0&&B[B.length-1].sender===E.f.SERVER&&B[B.length-1].inputLock)&&B[B.length-1].inputLock,input_lock_text:B&&B.length>0&&B[B.length-1].sender===E.f.SERVER&&B[B.length-1].inputLockMessage?B[B.length-1].inputLockMessage:"please select any option to proceed",skipLS:!!(B&&B.length>0&&B[B.length-1].sender===E.f.SERVER&&B[B.length-1].skipLS)&&B[B.length-1].skipLS,send_variable_to_apiai:!!(B&&B.length>0&&B[B.length-1].sender===E.f.SERVER&&B[B.length-1].send_variable_to_apiai)&&B[B.length-1].send_variable_to_apiai,sendVariableToLS:!!(B&&B.length>0&&B[B.length-1].sender===E.f.SERVER&&B[B.length-1].sendVariableToLS)&&B[B.length-1].sendVariableToLS,variable_name:B&&B.length>0&&B[B.length-1].sender===E.f.SERVER&&B[B.length-1].variable_name?B[B.length-1].variable_name:"",end_chat:Object(g.h)(g.a.END_CHAT,{visible:!1,show_confirmation_card:!1,show_resolved_card:!1,show_form_card:!1,form:[],description:null})}};function q(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function K(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?q(a,!0).forEach((function(t){Object(u.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):q(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V.chat_details,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f.UPDATE_STATE:return K({},e,Object(u.a)({},t.key,t.payload));case f.UPDATE_END_CHAT:var a=K({},e.end_chat,{},t.payload);return Object(g.s)(g.a.END_CHAT,a),K({},e,{end_chat:a});case f.HANDLE_CHATBOT_INTERFACE:return localStorage.setItem(g.a.IS_CHAT_OPEN,JSON.stringify(t.payload)),localStorage.removeItem(g.a.UNSEEN_MESSAGES),localStorage.removeItem(g.a.NOTIFICATION_COUNT),K({},e,{is_chat_open:t.payload,notification_count:t.payload?0:e.notification_count,unseen_messages:[]});case f.PUSH_SENDER_MESSAGE:localStorage.setItem(g.a.MESSAGES(),JSON.stringify([].concat(Object(j.a)(e.messages),[t.payload.message])));var n=Object(j.a)(e.unseen_messages),o=e.notification_count;return e.is_chat_open||(n=[].concat(Object(j.a)(e.unseen_messages),[t.payload.message]),o=0,localStorage.setItem(g.a.UNSEEN_MESSAGES,JSON.stringify(n)),localStorage.setItem(g.a.NOTIFICATION_COUNT,JSON.stringify(o))),K({},e,{unseen_messages:n,notification_count:o,messages:[].concat(Object(j.a)(e.messages),[t.payload.message]),skipLS:!1,send_variable_to_apiai:!1,sendVariableToLS:!1,variable_name:"",quick_replies:[],is_input_lock:!1});case f.PUSH_RESPONSE_MESSAGE:localStorage.setItem(g.a.MESSAGES(),JSON.stringify([].concat(Object(j.a)(e.messages),[t.payload.message])));var i=e.notification_count,r=Object(j.a)(e.unseen_messages);return e.is_chat_open||(i++,r=[].concat(Object(j.a)(e.unseen_messages),[t.payload.message]),localStorage.setItem(g.a.UNSEEN_MESSAGES,JSON.stringify(r)),localStorage.setItem(g.a.NOTIFICATION_COUNT,JSON.stringify(i))),K({},e,{notification_count:i,unseen_messages:r,messages:[].concat(Object(j.a)(e.messages),[t.payload.message]),quick_replies:t.payload.message.quickReplies?t.payload.message.quickReplies:[],is_input_lock:!!t.payload.message.inputLock&&t.payload.message.inputLock,input_lock_text:t.payload.message.inputLockMessage?t.payload.message.inputLockMessage:"please select any option to proceed",skipLS:t.payload.message.skipLS,sendVariableToLS:t.payload.message.sendVariableToLS,send_variable_to_apiai:t.payload.message.send_variable_to_apiai,variable_name:t.payload.message.variable_name});case f.SET_DEFAULT_STATE:var s=t.payload.messages.length,c=t.payload.messages;return K({},e,{messages:c,skipLS:!!(c&&s>0&&c[s-1].skipLS)&&c[s-1].skipLS,send_variable_to_apiai:!!(c&&s>0&&c[s-1].send_variable_to_apiai)&&c[s-1].send_variable_to_apiai,sendVariableToLS:!!(c&&s>0&&c[s-1].sendVariableToLS)&&c[s-1].sendVariableToLS,variable_name:c&&s>0&&c[s-1].variable_name?c[s-1].variable_name:"",quick_replies:c&&s>0&&c[s-1].quickReplies?c[s-1].quickReplies:[],is_input_lock:!!(c&&s>0&&c[s-1].inputLock)&&c[s-1].inputLock,input_lock_text:c&&s>0&&c[s-1].inputLockMessage?c[s-1].inputLockMessage:"please select any option to proceed",is_typing:!1,typing_text:""});case f.UPDATE_TYPING_INFO:return K({},e,{is_typing:t.payload.isTyping,typing_text:t.payload.typingMessage?t.payload.typingMessage:""});case f.UPDATE_FILE_UPLOAD_MESSAGE:var l=Object(j.a)(e.messages),d=-1;return-1!==(d=L()(l,(function(e){return e.chatlogId===t.payload.message.chatlogId})))&&(l=[].concat(Object(j.a)(l.slice(0,d)),[K({},l[d],{payload:K({},l[d].payload,{},t.payload.data)})],Object(j.a)(l.slice(d+1))),localStorage.setItem(g.a.MESSAGES(),JSON.stringify(l))),K({},e,{messages:l});case f.UPDATE_MESSAGE:var _=Object(j.a)(e.messages),p=-1;return-1!==(p=L()(_,(function(e){return e[t.key]===t.payload[t.key]})))&&(_=[].concat(Object(j.a)(_.slice(0,p)),[K({},_[p],{},t.payload.changedValue)],Object(j.a)(_.slice(p+1))),localStorage.setItem(g.a.MESSAGES(),JSON.stringify(_))),K({},e,{messages:_});case f.MESSAGE_SEEN:for(var S=Object(j.a)(e.messages),h=0;h<S.length;h++)S[h].readStatus===E.e.DELIVERED&&S[h].sender===E.f.CUSTOMER&&(S[h]=K({},S[h],{readStatus:E.e.SEEN}));return K({},e,{messages:S});default:return e}},J={page_details:{device_data:{},is_adster_bot:!1}};function X(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?X(a,!0).forEach((function(t){Object(u.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):X(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Q=Object(d.c)({chat_details:W,page_details:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J.page_details,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f.DEVICE_DATA_LOADED:return Y({},e,{device_data:t.payload.device_data});case f.ENABLE_ADSTER_BOT:return Y({},e,{is_adster_bot:t.payload});default:return e}}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(277);var z=a(36),$=a(37),Z=a(40),ee=a(38),te=a(39),ae=a(149),ne=a.n(ae),oe=a(150),ie=a.n(oe),re=a(146),se=a.n(re),ce=(a(340),function(e){return{type:f.DEVICE_DATA_LOADED,payload:{device_data:e}}}),le=function(){return{type:f.ENABLE_ADSTER_BOT,payload:!0}},de=a(98),ue=a.n(de),_e=a(151),pe=a.n(_e),Ee=a(152),Se=a.n(Ee),ge=(a(346),function(e){function t(){var e,a;Object(z.a)(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(a=Object(Z.a)(this,(e=Object(ee.a)(t)).call.apply(e,[this].concat(o)))).lottieDefaultOptions={loop:!0,autoplay:!0,path:S.a.trigger.lottie_path,rendererSettings:{preserveAspectRatio:"xMidYMid slice"}},a.handleChatInterfaceView=function(){var e=a.props,t=e.is_chat_open;(0,e.handleSocketConnection)(!t)},a}return Object(te.a)(t,e),Object($.a)(t,[{key:"render",value:function(){var e=this.props.is_chat_open;return r.a.createElement("div",{className:"ori-fixed ori-animated ori-zoom-in oriTriggerChatBotContainer",onClick:this.handleChatInterfaceView},!e&&S.a.trigger.lottie_visibility&&r.a.createElement(Se.a,{options:this.lottieDefaultOptions,height:S.a.trigger.lottie_icon_height,width:S.a.trigger.lottie_icon_width}),S.a.trigger.visibility&&!e&&r.a.createElement("div",{className:"ori-animated ori-pulse ori-infinite",style:{height:"".concat(S.a.trigger.icon_height,"px"),animationDuration:"".concat(S.a.trigger.animation_duration,"ms")}},r.a.createElement("img",{src:S.a.trigger.icon_url,alt:"",className:"ori-full-parent-height"})),!S.a.trigger.visibility&&!S.a.trigger.lottie_visibility&&!e&&r.a.createElement("div",{className:"ori-flex-row ori-flex-center triggerIconContainer"},r.a.createElement(pe.a,{size:30})),e&&S.a.trigger.show_close_icon&&r.a.createElement("div",{className:"ori-flex-row ori-flex-center triggerIconContainer"},r.a.createElement(ue.a,{size:28})))}}]),t}(r.a.PureComponent));function fe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function he(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?fe(a,!0).forEach((function(t){Object(u.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):fe(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Te=r.a.lazy((function(){return Promise.all([a.e(0),a.e(1),a.e(6)]).then(a.bind(null,527))})),be=r.a.lazy((function(){return Promise.all([a.e(0),a.e(1),a.e(9)]).then(a.bind(null,526))})),Oe=function(e){function t(e){var a;return Object(z.a)(this,t),(a=Object(Z.a)(this,Object(ee.a)(t).call(this,e))).handleConnectionChange=function(){var e=a.props.actions;if("online"!==(navigator.onLine?"online":"offline"))return e.updateState("is_internet_connected",!1);var t=setInterval((function(){fetch("//google.com",{mode:"no-cors"}).then((function(){e.updateState("is_internet_connected",!0),clearInterval(t)})).catch((function(){return e.updateState("is_internet_connected",!1)}))}),1500)},a.botPopup=function(e,t){var n=a.props,o=n.chat_details,i=n.actions,r={case:e,params:t,psid:o.psid};i.handleBotPopupRequest(r)},a.handleSocketConnection=function(e){var t=a.props,n=t.chat_details,o=t.actions,i=Object(g.p)();if(o.handleChatbotInterface(e),e&&n.is_socket_connected){var r={clientPsid:n.psid,senderPsid:n.psid};o.emitCustomEvent(E.d.MESSAGE_SEEN,r)}!e||n.is_socket_connected||i||o.makeSocketConnection()},a.handleOfferSelection=function(e,t){a.setState({selected_offer:he({},a.state.selected_offer,{offer_id:e,offer_name:t})})},a.setDefaultOfferState=function(){a.setState({selected_offer:he({},a.state.selected_offer,{offer_id:null,offer_name:null})})},a.onChangeCheckbox=function(e){a.setState({selected_checkbox_values:e})},a.emitResponseToServer=function(e){var t=a.props,n=t.chat_details,o=t.actions,i=Object(g.p)(),r=he({},e,{sender_id:S.a.sender_id,navigator_userAgent:navigator.userAgent,navigator_platform:navigator.platform,variable_name:n.variable_name,send_variable_to_apiai:n.send_variable_to_apiai,sendVariableToLS:n.sendVariableToLS,skipLS:n.skipLS});i&&localStorage.getItem(g.a.APP_PARAMS)&&(r.lockedParams=JSON.parse(localStorage.getItem(g.a.APP_PARAMS)),localStorage.removeItem(g.a.APP_PARAMS)),o.emitNewMessageToServer(r);var s=(new Date).getTime();localStorage.setItem(g.a.LAST_EMIT,JSON.stringify(s))},a.pushSenderNewMsgToChatbot=function(e,t){var n=a.props.actions,o=he({type:e,sender_id:S.a.sender_id,timestamp:new Date,sender:E.f.CUSTOMER,readStatus:E.e.SENDING},t);n.pushSenderMessage(o)},a.sendTextToServer=function(e){var t=Object(g.t)(),n={type:E.h.TEXT,text:e,cmid:t},o={payload:{text:e},cmid:t};a.emitResponseToServer(n),a.pushSenderNewMsgToChatbot(E.h.TEXT,o)},a.handleButtonSubTypes=function(e){switch(i.button.subtype){case E.a.DISH_OFFERS:var t=a.state.selected_offer,n=Object(g.t)(),o={type:E.h.TEXT,text:t.offer_id,cmid:n},i={payload:{text:t.offer_name},cmid:n};a.pushSenderNewMsgToChatbot(E.h.TEXT,i),a.emitResponseToServer(o),t.offer_id&&a.setDefaultOfferState();break;case E.a.CHECKBOX_SUBMIT:if(i.message&&i.message.payload&&i.message.payload.options){var r=a.state.selected_checkbox_values,s=i.message.payload.options.filter((function(e){return-1!==r.findIndex((function(t){return t===e.value}))}));if(s.length>0){var c=Object(g.t)(),l={type:E.h.LIST,list:s,relayData:i.button.relayData,cmid:c},d={payload:{list:s},cmid:c};a.pushSenderNewMsgToChatbot(E.h.LIST,d),a.emitResponseToServer(l)}}break;default:return}},a.handleMsgBtnClick=function(e){if(e.button)switch(e.button.type){case E.b.LINK:if(e.button.url&&e.button.url.trim().length>0)!!localStorage.getItem(g.a.ANDROID)&&JSON.parse(localStorage.getItem(g.a.ANDROID))?window.androidObj.textToAndroid(JSON.stringify(e)):window.open(e.button.url,"_blank");break;case E.b.CUSTOM:e.button.subtype&&a.handleButtonSubTypes(e);break;case E.b.CUSTOM_SOCKET_EVENT:var t=Object(g.t)();if(e.button.text){var n={payload:{text:e.button.text},cmid:t};a.pushSenderNewMsgToChatbot(E.h.TEXT,n)}if(e.button.eventName){var o={relayData:ie()({},e.message.relayData,e.button.relayData),text:e.message.payload.title,type:e.message.payload&&e.message.payload.expectedClientResponseType?e.message.payload.expectedClientResponseType:E.h.TEXT,cmid:t};a.props.actions.emitCustomEvent(e.button.eventName,o)}break;case E.b.POST_BACK_RESPONSE:var i=Object(g.t)();if(e.button.text){var r={payload:{text:e.button.text},cmid:i};a.pushSenderNewMsgToChatbot(E.h.TEXT,r)}if(e.button.postbackRes){var s={type:E.h.TEXT,text:e.button.postbackRes,cmid:i};a.emitResponseToServer(s)}break;default:e.button.text&&a.sendTextToServer(e.button.text)}},a.handleFileUpload=function(e,t){if(e&&e.fileUrl&&e.file){if(console.log("upload data",e),t){var n={data:e,message:t};a.props.actions.updateFileUploadMessage(n)}var o=Object(g.t)(),i={type:E.h.FILE,relayData:t&&t.payload?t.payload.relayData:null,fileBase64:e.fileUrl,cmid:o};a.emitResponseToServer(i);var r={payload:{title:e.file.name,imageUrl:e.fileUrl},cmid:o};a.pushSenderNewMsgToChatbot(E.h.IMAGE_WITH_BUTTONS,r)}},window.androidObj=function(){},e.actions.setDeviceData(g.c.deviceStatus()),a.timeout=!1,a.state={selected_checkbox_values:[],selected_offer:{offer_id:null,offer_name:null}},a}return Object(te.a)(t,e),Object($.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.chat_details,n=t.actions,o=Object(g.p)(),i=this;if(window.bot_popup=this.botPopup,window.addEventListener("resize",(function(){clearTimeout(e.timeout),e.timeout=setTimeout((function(){i.props.actions.setDeviceData(g.c.deviceStatus())}),300)})),this.handleConnectionChange(),window.addEventListener("online",this.handleConnectionChange),window.addEventListener("offline",this.handleConnectionChange),document.addEventListener("visibilitychange",(function(){if("visible"===document.visibilityState&&i.props.chat_details.is_chat_open){var e={clientPsid:i.props.chat_details.psid,senderPsid:i.props.chat_details.psid};i.props.actions.emitCustomEvent(E.d.MESSAGE_SEEN,e)}})),o)window.androidObj.updateFromAndroid=function(e,t){e.toLowerCase()===g.b.ANDROID?localStorage.setItem(g.a.ANDROID,JSON.stringify(!0)):"psid"===e.toLowerCase()&&((t=JSON.parse(t)).psid&&(localStorage.setItem(g.a.PSID,t.psid),n.updateState("psid",t.psid)),t.params&&localStorage.setItem(g.a.APP_PARAMS,JSON.stringify(t.params)),a.is_socket_connected||(n.makeSocketConnection(),n.setDefaultState()))},n.handleChatbotInterface(!0);else if(!a.is_socket_connected){var r=localStorage.getItem(g.a.LAST_EMIT)?JSON.parse(localStorage.getItem(g.a.LAST_EMIT)):null;if(r){var s=((new Date).getTime()-r)/1e3;if(s<S.b.automate_connection_time?n.makeSocketConnection():n.handleChatbotInterface(!1),s>S.b.automate_reset_chat_time){var c=Object(g.i)();localStorage.setItem(g.a.MESSAGES,JSON.stringify(c)),n.setDefaultState()}}else n.handleChatbotInterface(!1);if(S.b.adster_bot.visibility)new URLSearchParams(window.location.search).get(S.b.adster_bot.query_param_key)&&(this.handleSocketConnection(!0),n.enableAdsterBot())}}},{key:"componentWillUnmount",value:function(){var e=this.props.actions;window.removeEventListener("online",this.handleConnectionChange),window.removeEventListener("offline",this.handleConnectionChange),e.socketDisconnect()}},{key:"render",value:function(){var e=this.props,t=e.page_details,a=e.chat_details,n=e.actions;return r.a.createElement("div",{className:"ori-app-container ori-ant-design-container oriAppContainer"},r.a.createElement(ne.a,{count:a.notification_count,overflowCount:9,className:"ori-animated ori-fade-in notificationBadge"},r.a.createElement(ge,{is_chat_open:a.is_chat_open,handleSocketConnection:this.handleSocketConnection})),r.a.createElement(i.Suspense,{fallback:r.a.createElement("div",null,r.a.createElement(se.a,{className:"ori-l-mrgn-5 ori-animated ori-rotate ori-infinite"}))},a.is_chat_open&&r.a.createElement(Te,{is_adster_bot:t.is_adster_bot,chat_details:a,actions:n,sendTextToServer:this.sendTextToServer,handleMsgBtnClick:this.handleMsgBtnClick,handleFileUpload:this.handleFileUpload,handleOfferSelection:this.handleOfferSelection,onChangeCheckbox:this.onChangeCheckbox}),S.b.notification_bot.visibility&&!a.is_chat_open&&a.unseen_messages.length>0&&r.a.createElement(be,{page_details:t,chat_details:a,actions:n,sendTextToServer:this.sendTextToServer,handleMsgBtnClick:this.handleMsgBtnClick,handleFileUpload:this.handleFileUpload,handleOfferSelection:this.handleOfferSelection,stack_view:S.b.notification_bot.stack_view,onChangeCheckbox:this.onChangeCheckbox})))}}]),t}(i.Component),me=Object(l.b)((function(e){return{chat_details:e.chat_details,page_details:e.page_details}}),(function(e){return{actions:Object(d.b)(Object.assign({},o,n),e)}}))(Oe),ye=function(){var e=[R];return Object(d.e)(Q,Object(d.d)(d.a.apply(void 0,e),window.devToolsExtension?window.devToolsExtension():function(e){return e}))}(),Ae=document.createElement("DIV");Ae.setAttribute("id","ori-chatbot-root"),document.body.appendChild(Ae),c.a.render(r.a.createElement(l.a,{store:ye},r.a.createElement(me,null)),document.getElementById("ori-chatbot-root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},4:function(e,t,a){"use strict";a.d(t,"d",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return s})),a.d(t,"c",(function(){return c}));var n=a(1),o=a(2),i=function(){return"".concat("https://vodafone-dev.oriserve.in","/liveConversations?psid=").concat(Object(n.o)(),"&ver=").concat(1.1,"&role=user&brandName=").concat("vodafone","&botName=").concat("vodafone","&channelName=").concat(Object(n.n)())},r={sentry_dsn:"https://fa80a3e669cc4ee78bcb94c405adecba@sentry.io/1512125",icon_url:"https://d113ddgi4j6d7k.cloudfront.net/dashboard/ava.png",brand_name:"Vodafone",sender_id:"dish_chat_client",trigger:{visibility:!1,icon_url:"https://d113ddgi4j6d7k.cloudfront.net/dashboard/ava.png",icon_height:90,mobile_icon_width:80,animation_duration:2e3,lottie_visibility:!0,lottie_path:"https://d113ddgi4j6d7k.cloudfront.net/dashboard/cue.json",lottie_icon_height:70,lottie_icon_width:70,show_close_icon:!0}},s={automate_connection_time:3600,automate_reset_chat_time:345600,powered_by:{visibility:!0,target_url:"http://oriserve.com/",icon_url:"https://d113ddgi4j6d7k.cloudfront.net/ori_logo.png"},notification_bot:{visibility:!0,stack_view:!1},chat_interface:{show_bg_image:!0,bg_image_url:"https://d113ddgi4j6d7k.cloudfront.net/dashboard/chat_interface.jpg"},adster_bot:{query_param_key:"ischatbotopen",visibility:!0},auto_emit_response:{enable:!0,payload:{type:o.h.TEXT,text:"first emit message"}}},c={common:{socket_connection_lost:"connection has been lost"},feedback:{greeting:"How happy are you with our support ?",low_rated:"Please tell us what went wrong.",high_rated:"Please suggest how can we make your next visit awesome.",success:"Thank you for giving us feedback",failed:"Some error occured please try again later"}}}},[[167,3,4]]]);
//# sourceMappingURL=main.1f4fc18f.chunk.js.map